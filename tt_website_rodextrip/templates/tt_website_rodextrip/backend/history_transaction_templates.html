{% extends 'tt_website_rodextrip/template_website_booking.html' %}
{% load i18n %}
{% load static from staticfiles %}
{% block content %}
<!--<script src="{{ static_path }}js/webservice_token.js"></script>-->
<!--<script src="{{ static_path }}vendor/jquery/jquery-3.2.1.min.js?version={{javascript_version}}"></script>-->
<script src="{{ static_path }}js/webservice_token.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/webservice_agent.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/webservice_account.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/webservice_airline.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/agent_javascript.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/moment.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/webservice_printout.js?version={{javascript_version}}"></script>
<script>
    static_path_url_server = '{{static_path_url_server}}'

</script>
<title>{{name}} - {% trans 'History Transaction' %}</title>

{% include 'tt_website_rodextrip/logout.html' %}
{% include 'tt_website_rodextrip/header.html' %}
{% if template == 1%}
<section class="destinations-area" style="padding-top:30px; padding-bottom:40px;">
{% elif template == 2%}
<section style="padding-top:30px; padding-bottom:40px; background:#f7f7f7;">
{% elif template == 3%}
<section class="relative" style="padding:50px 0px 50px 0px; background:#f7f7f7; border-bottom:2px solid #cdcdcd;">
{% elif template == 4%}
<section style="padding:50px 0px 50px 0px; background:#f7f7f7;">
{% elif template == 5%}
<section style="padding:50px 0px 50px 0px; background:white; border-bottom:2px solid #cdcdcd; background:#f7f7f7;">
{% elif template == 6%}
<section style="padding:50px 0px 50px 0px; background:white; border-bottom:2px solid #cdcdcd; background:#f7f7f7;">
{% endif %}
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="form-wrap" style="margin-bottom:15px; border-bottom:3px solid {{color}}; width:fit-content;">
                    <h3>{% trans 'History Transaction' %}</h3>
                </div>
            </div>

            <div class="col-lg-12">
                <div class="form-wrap" style="margin-bottom:25px; background:white; padding:15px; border:1px solid #cdcdcd;">
                    <h4>{% trans 'Search by' %}</h4>
                    {%if template == 1%}
                    <div class="row banner-right">
                        <div class="col-lg-12 form-wrap" style="padding:15px; text-align:left;" id="search">
                            <div class="row">
                                <div class="col-lg-4 col-md-4">
                                    <span><i class="fas fa-calendar-alt"></i> {% trans 'Start Date' %}</span>
                                    <div class="input-container-search-ticket">
                                        <input type="text" class="form-control" name="start_date" id="start_date" placeholder="{% trans 'Start Date' %} " onfocus="this.placeholder = ''" onblur="this.placeholder = 'Start Date '" autocomplete="off" readonly>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4">
                                    <span><i class="fas fa-calendar-alt"></i> {% trans 'End Date' %}</span>
                                    <div class="input-container-search-ticket">
                                        <input type="text" class="form-control" name="end_date" id="end_date" placeholder="{% trans 'End Date' %} " onfocus="this.placeholder = ''" onblur="this.placeholder = 'End Date '" autocomplete="off" readonly>
                                    </div>
                                </div>

                                <div class="col-lg-4 col-md-4">
                                    <br/>
                                    <input type="button" class="primary-btn-custom" style="width:100%; height:43px;" value="Search" onclick="transaction_history_click_search(); get_transaction_history_ledger('reset','false');" id="button" disabled/>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% elif template == 2 %}
                    <div class="row hotel-search-form-area" style="bottom:0px; padding-left:15px; padding-right:15px;">
                        <div class="col-lg-12 hotel-search-form" style="background-color:unset; padding:unset; box-shadow:unset;" id="search">
                            <div class="row">
                                <div class="col-lg-4 col-md-4">
                                    <span><i class="fas fa-calendar-alt"></i> {% trans 'Start Date' %}</span>
                                    <div class="input-container-search-ticket">
                                        <input type="text" style="background:white;" class="form-control" name="start_date" id="start_date" placeholder="{% trans 'Start Date' %} " onfocus="this.placeholder = ''" onblur="this.placeholder = 'Start Date '" autocomplete="off" readonly>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4">
                                    <span><i class="fas fa-calendar-alt"></i> {% trans 'End Date' %}</span>
                                    <div class="input-container-search-ticket">
                                        <input type="text" style="background:white;" class="form-control" name="end_date" id="end_date" placeholder="{% trans 'End Date' %} " onfocus="this.placeholder = ''" onblur="this.placeholder = 'End Date '" autocomplete="off" readonly>
                                    </div>
                                </div>

                                <div class="col-lg-4 col-md-4">
                                    <br/>
                                    <input type="button" class="primary-btn-custom" style="width:100%; height:43px;" value="Search" onclick="transaction_history_click_search(); get_transaction_history_ledger('reset','false');" id="button" disabled />
                                </div>
                            </div>
                        </div>
                    </div>
                    {% elif template == 3 %}
                    <div class="row fullscreen d-flex" style="bottom:0px; padding-left:15px; padding-right:15px;">
                        <div class="col-lg-12 header-right" style="background-color:unset; padding:unset; box-shadow:unset; border:unset;" id="search">
                            <div class="row">
                                <div class="col-lg-4 col-md-4">
                                    <span><i class="fas fa-calendar-alt"></i> {% trans 'Start Date' %}</span>
                                    <div class="input-container-search-ticket">
                                        <input type="text" style="background:white;" class="form-control" name="start_date" id="start_date" placeholder="{% trans 'Start Date' %} " onfocus="this.placeholder = ''" onblur="this.placeholder = 'Start Date '" autocomplete="off" readonly>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4">
                                    <span><i class="fas fa-calendar-alt"></i> {% trans 'End Book Date' %}</span>
                                    <div class="input-container-search-ticket">
                                        <input type="text" style="background:white;" class="form-control" name="end_date" id="end_date" placeholder="{% trans 'End Date' %} " onfocus="this.placeholder = ''" onblur="this.placeholder = 'End Date '" autocomplete="off" readonly>
                                    </div>
                                </div>

                                <div class="col-lg-4 col-md-4">
                                    <br/>
                                    <input type="button" class="primary-btn-custom" style="width:100%; height:43px;" value="Search" onclick="transaction_history_click_search(); get_transaction_history_ledger('reset','false');" id="button" disabled/>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% elif template == 4 %}
                    <div class="row align-items-end justify-content-center">
                        <div class="banner-content col-xl-12 search-field" style="" id="search">
                            <div class="row">
                                <div class="col-lg-4 col-md-4">
                                    <span><i class="fas fa-calendar-alt"></i> {% trans 'Start Date' %}</span>
                                    <div class="input-container-search-ticket">
                                        <input type="text" style="background:white;" class="form-control" name="start_date" id="start_date" placeholder="{% trans 'Start Date' %} " onfocus="this.placeholder = ''" onblur="this.placeholder = 'Start Date '" autocomplete="off" readonly>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4">
                                    <span><i class="fas fa-calendar-alt"></i> {% trans 'End Date' %}</span>
                                    <div class="input-container-search-ticket">
                                        <input type="text" style="background:white;" class="form-control" name="end_date" id="end_date" placeholder="{% trans 'End Date' %} " onfocus="this.placeholder = ''" onblur="this.placeholder = 'End Date '" autocomplete="off" readonly>
                                    </div>
                                </div>

                                <div class="col-lg-4 col-md-4">
                                    <br/>
                                    <input type="button" class="primary-btn-custom" style="width:100%; height:43px;" value="Search" onclick="transaction_history_click_search(); get_transaction_history_ledger('reset','false');" id="button" disabled/>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% elif template == 5 %}
                    <div class="row banner-right">
                        <div class="col-lg-12 form-wrap" style="padding:15px; text-align:left;" id="search">
                            <div class="row">
                                <div class="col-lg-4 col-md-4">
                                    <span><i class="fas fa-calendar-alt"></i> {% trans 'Start Date' %}</span>
                                    <div class="input-container-search-ticket">
                                        <input type="text" style="background:white;" class="form-control" name="start_date" id="start_date" placeholder="{% trans 'Start Date' %} " onfocus="this.placeholder = ''" onblur="this.placeholder = 'Start Date '" autocomplete="off" readonly>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4">
                                    <span><i class="fas fa-calendar-alt"></i> {% trans 'End Book Date' %}</span>
                                    <div class="input-container-search-ticket">
                                        <input type="text" style="background:white;" class="form-control" name="end_date" id="end_date" placeholder="{% trans 'End Date' %} " onfocus="this.placeholder = ''" onblur="this.placeholder = 'End Date '" autocomplete="off" readonly>
                                    </div>
                                </div>

                                <div class="col-lg-4 col-md-4">
                                    <br/>
                                    <input type="button" class="primary-btn-custom" style="width:100%; height:43px;" value="Search" onclick="transaction_history_click_search(); get_transaction_history_ledger('reset','false');" id="button" disabled/>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% elif template == 6 %}
                    <div class="row banner-right">
                        <div class="col-lg-12 form-wrap" style="padding:15px; text-align:left;" id="search">
                            <div class="row">
                                <div class="col-lg-4 col-md-4">
                                    <span><i class="fas fa-calendar-alt"></i> {% trans 'Start Date' %}</span>
                                    <div class="input-container-search-ticket">
                                        <input type="text" style="background:white;" class="form-control" name="start_date" id="start_date" placeholder="{% trans 'Start Date' %} " onfocus="this.placeholder = ''" onblur="this.placeholder = 'Start Date '" autocomplete="off" readonly>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4">
                                    <span><i class="fas fa-calendar-alt"></i> {% trans 'End Book Date' %}</span>
                                    <div class="input-container-search-ticket">
                                        <input type="text" style="background:white;" class="form-control" name="end_date" id="end_date" placeholder="{% trans 'End Date' %} " onfocus="this.placeholder = ''" onblur="this.placeholder = 'End Date '" autocomplete="off" readonly>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4">
                                    <br/>
                                    <input type="button" class="primary-btn-custom" style="width:100%; height:43px;" value="Search" onclick="transaction_history_click_search(); get_transaction_history_ledger('reset','false');" id="button"/>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>
                <div style="width:100%; overflow:auto;" id="body_table_reservation">

                </div>
                <div id="loading-search-reservation" style="margin-bottom:20px;">
                    <div class="col-lg-12">
                        <div class="sk-circle">
                            <div class="sk-circle1 sk-child"></div>
                            <div class="sk-circle2 sk-child"></div>
                            <div class="sk-circle3 sk-child"></div>
                            <div class="sk-circle4 sk-child"></div>
                            <div class="sk-circle5 sk-child"></div>
                            <div class="sk-circle6 sk-child"></div>
                            <div class="sk-circle7 sk-child"></div>
                            <div class="sk-circle8 sk-child"></div>
                            <div class="sk-circle9 sk-child"></div>
                            <div class="sk-circle10 sk-child"></div>
                            <div class="sk-circle11 sk-child"></div>
                            <div class="sk-circle12 sk-child"></div>
                        </div>
                        <div style="text-align:center"><h6>PLEASE WAIT</h6></div>
                    </div>
                </div>
                <center><div class="alert alert-danger" id="reservation_found" role="alert" style="margin-top:10px; display:none;"><h6><i class="fas fa-search-minus"></i> Oops! Data History Transaction not found!</h6></div></center>
                <div id="desc">
                </div>
            </div>
        </div>
    </div>
</section>


<script>
    var text = '';

    $(document).ready(function () {
        $(window).scroll(function() {
            if($(window).scrollTop() >= $(document).height() - ($(window).height() + 600)) {
                if(load_more == true){
                    //get_agent_booking();
                    get_transaction_history_ledger('','false');
                }
            }
        });
        $(".enter_reservation").keypress(function(event) {
            if (event.keyCode === 13) {
                $("#button").click();
            }
        });

        try{
            $('input[name="start_date"]').daterangepicker({
              singleDatePicker: true,
              autoUpdateInput: true,
              startDate: moment(),
              minDate: moment().subtract(+730, 'days'),
              maxDate: moment(),
              showDropdowns: true,
              opens: 'center',
              locale: {
                  format: 'DD MMM YYYY',
              }
            });
            $('input[name="end_date"]').daterangepicker({
              singleDatePicker: true,
              autoUpdateInput: true,
              startDate: moment(),
              minDate: moment(),
              maxDate: moment(),
              showDropdowns: true,
              opens: 'center',
              locale: {
                  format: 'DD MMM YYYY',
              }
            });

            $('input[name="end_date"]').change(function() {
                min_date = document.getElementById('end_date').value;
                if(document.getElementById('start_date').value != '')
                    pick_date = document.getElementById('start_date').value;
                else
                    pick_date = document.getElementById('end_date').value;

                $('input[name="start_date"]').daterangepicker({
                  singleDatePicker: true,
                  autoUpdateInput: true,
                  opens: 'center',
                  startDate: pick_date,
                  minDate: moment().subtract(+730, 'days'),
                  maxDate: min_date,
                  showDropdowns: true,
                  locale: {
                      format: 'DD MMM YYYY',
                  }
                });
            });

            $('input[name="start_date"]').change(function() {
                min_date = document.getElementById('start_date').value;
                if(document.getElementById('end_date').value != '')
                    pick_date = document.getElementById('end_date').value;
                else
                    pick_date = document.getElementById('start_date').value;

                console.log(pick_date);
                console.log(min_date);
                $('input[name="end_date"]').daterangepicker({
                  singleDatePicker: true,
                  autoUpdateInput: true,
                  opens: 'center',
                  startDate: pick_date,
                  minDate: min_date,
                  maxDate: moment(),
                  showDropdowns: true,
                  locale: {
                      format: 'DD MMM YYYY',
                  }
                });
            });
        }catch(err){
            console.log(err) //ada element yg tidak ada
        }
        signin_rodextrip('history_transaction');
    });
</script>
{% include 'tt_website_rodextrip/footer.html' %}
{% endblock %}
