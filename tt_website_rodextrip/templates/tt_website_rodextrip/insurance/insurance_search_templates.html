{% extends 'tt_website_rodextrip/template_website_booking.html' %}
{% load i18n %}
{% load static from staticfiles %}
{% block content %}
<!--<script src="{{ static_path }}js/webservice_token.js"></script>-->
<!--<script src="{{ static_path }}vendor/jquery/jquery-3.2.1.min.js?version={{javascript_version}}"></script>-->
<script src="{{ static_path }}js/webservice_token.js?version={{javascript_version}}"></script>
<!--<script src="{{ static_path }}js/activity_javascript.js?version={{javascript_version}}"></script>-->
<script src="{{ static_path }}js/agent_javascript.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/webservice_insurance.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/webservice_agent.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/webservice_account.js?version={{javascript_version}}"></script>
<script>
    static_path_url_server = '{{static_path_url_server}}';
    offset = 600;
    get_new = true;
    name = '';
    time_limit = {{time_limit}};
    last_session = 'get_details';
    session_time_limit();
</script>

{% include 'tt_website_rodextrip/header.html' %}
{% include 'tt_website_rodextrip/logout.html' %}
{% include 'tt_website_rodextrip/plugin_passenger.html' %}

<title id="title_search">{{name}} {% trans 'Insurance' %}</title>

<button class="primary-btn-ticket btn_icon_fixed my_sticky_button" style="left:51%; width:20vw; height:50px; bottom:55px; position:fixed; z-index:99;" data-toggle="modal" data-target="#myModalSort">
    <span style="color:{{text_color}}; font-size:12px;"> <i class="fas fa-sort" style="font-size:20px;"></i> <span class="span_icon_fixed">{% trans 'Sort' %}</span>  </span>
</button>
<button class="primary-btn-ticket btn_icon_fixed my_sticky_button" style="right:51%; width:20vw; height:50px; bottom:55px; position:fixed; z-index:99;" data-toggle="modal" data-target="#myModalFilter">
    <span style="color:{{text_color}}; font-size:12px;"> <i class="fas fa-filter"></i> <span class="span_icon_fixed">{% trans 'Filter' %}</span>  </span>
</button>
<div id="overlay-search-box" onclick="off_overlay()"></div>

{%if template == 1%}
<section class="destinations-area" style="padding:15px 0px 15px 0px; background:white; border-bottom:2px solid #cdcdcd; position:sticky; top:0px; z-index:10;">
    <div class="container">
        <div class="row">
            <div class="col-lg-8" style="text-align:left;">
                <span style="text-transform: capitalize;">{% trans 'Insurance Search' %}</span><br/>
                <br/>
            </div>
            <div class="col-lg-4" style="text-align:right;">
                <button class="primary-btn-custom" type="button" onclick="show_hide_change_search();">
                    <i class="fas fa-search" style="color:{{text_color}}; font-weight:bold; font-size:18px;"></i>
                    <span id="change_search_text">{% trans 'Change Search' %}</span>
                </button>
            </div>
        </div>
    </div>
</section>
<section class="price-area" id="change_search_box" data-aos="fade-up" style="padding-top:30px; padding-bottom:5px; background-color: black; z-index:3; position:relative; display:none">
    <div class="overlay overlay-bg"></div>
    <div class="container" id="div-search-overlay">
        <div class="row">
            <div class="col-lg-12" style="padding:0;">
                <div class="banner-right">
                    <form action="{% url 'tt_website_rodextrip:insurance_search'%}" method="POST" class="form-wrap" id="insurance_searchForm">
                        {% csrf_token %}
                        <input type="hidden" name="g-recaptcha-response" id='recaptcha_insurance'>
                        <div class="row">
                            <div class="col-lg-6 col-md-6 col-sm-6" style="padding:0px;" id="insurance_date_search">
                                <span class="span-search-ticket"><i class="fas fa-calendar-alt"></i> {% trans 'Date' %}</span>
                                <div class="input-container-search-ticket">
                                    <input type="text" class="form-control" id="insurance_date" name="insurance_date" placeholder="{% trans 'Date' %} " onfocus="this.placeholder = ''" onblur="this.placeholder = 'Date '" autocomplete="off" readonly/>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-6" style="padding:0px;">
                                <span class="span-search-ticket"><i class="fas fa-users"></i> {% trans 'Passenger' %}</span>
                                <div class="input-container-search-ticket btn-group">
                                    <button id="show_total_pax_insurance" style="text-align:left; cursor:pointer;" type="button" class="form-control dropdown-toggle" data-toggle="dropdown"></button>
                                    <ul class="dropdown-menu" role="menu">
                                        <div class="row" style="padding:10px;">
                                            <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5" style="float:left !important;">
                                                <div style="float:left;">
                                                    <label>
                                                        <span style="color:black; font-size:13px;">{% trans 'Passenger' %}<br/></span>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-lg-7 col-md-7 col-sm-7 col-xs-7" style="float:right !important;">
                                                <div style="float:right; display:flex; padding:5px 0px 5px 5px;">
                                                    <button type="button" class="left-minus-adult-bus btn-custom-circle" id="left-minus-adult-insurance" data-type="minus" data-field="" disabled>
                                                        <i class="fas fa-minus"></i>
                                                    </button>
                                                    <input type="text" style="font-size:13px; padding:5px !important; border:none; background:none; font-size:13px; text-align:center; width:25px;" id="insurance_adult" name="insurance_adult" value="1" min="1" readonly>
                                                    <button type="button" class="right-plus-adult-bus btn-custom-circle" id="right-plus-adult-insurance" data-type="plus" data-field="">
                                                        <i class="fas fa-plus"></i>
                                                    </button>
                                                </div>
                                            </div>

                                            <div class="col-lg-12" style="text-align:right;">
                                                <hr/>
                                                <button class="primary-btn" type="button" style="line-height:34px;" onclick="next_focus_element('insurance','passenger');">Done</button>
                                            </div>
                                        </div>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <br/>

                        <input type="hidden" id="insurance_response" name="response"/>
                        <center>
                            <button class="primary-btn ld-ext-right" id="btn-search-insurance" type="button" onclick="get_captcha('recaptcha_insurance','insurance');" value="Submit">
                                <i class="fas fa-search" style="color:{{text_color}}; font-weight:bold; font-size:18px;"></i>
                                {% trans 'Search' %}
                                <div class="ld ld-ring ld-cycle"></div>
                            </button>
                        </center>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>
{%endif%}

<section class="destinations-area" style="padding-top:30px; padding-bottom:40px; background:#f7f7f7;">
    <div class="container">
        <div class="row" style="padding-bottom:10px;">
            <div class="col-lg-12" id="breadcrumbs_create">

            </div>
        </div>

        <div class="row">
            <div class="col-lg-3">
                {% if username.co_user_login != 'agent_b2c' %}
                <div class="row" id="info_user_search" style="padding-top:15px; padding-bottom:5px; position: sticky; top: 51px; z-index: 2; display:none;">
                    <div class="col-lg-12">
                        <div style="padding:10px; background:white; border:1px solid #cdcdcd;">
                            <span title="{{username.co_user_login}}" style="font-size:14px; font-weight:600; cursor:text; color:black; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width:150px;"><img src="{{static_path}}images/noprofile.png" alt="Photo Profile" class="image-rounded-profile"/> {{username.co_user_login}}</span>
                            <hr/>
                            <a id="balance_search" style="font-size:13px; font-weight:500; border-bottom:2px solid {{color}};"></a><br/>
                            <span id="credit_search" style="font-size:13px; font-weight:500; padding-right:10px;"></span>
                        </div>
                    </div>
                </div>
                {% endif %}

                <div style="background-color:white; padding:10px; margin-top:20px; border:1px solid #cdcdcd" id="session_timer">
                    <span style="font-size:14px; font-weight:600;">Session Time <span class="count_time" id="session_time"> </span></span>
                    <hr/>
                    <span style="font-size:14px; font-weight:600;">Elapsed Time <span class="count_time" id="elapse_time"> </span></span>
                </div>

                <div class="modal fade" id="myModalFilter" role="dialog">
                    <div class="modal-dialog">
                        <!-- Modal content-->
                        <div class="modal-content">
                            <div class="modal-header">
                                <h4 class="modal-title" style="color:{{text_color}};"> Filter</i></h4>
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                            </div>
                            <div class="modal-body">
                                <div class="row" style="min-height=100px; max-height:400px; overflow-y: scroll;">
                                    <div class="col-lg-12">
                                        <div id="filter2">

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal fade" id="myModalSort" role="dialog">
                    <div class="modal-dialog">
                        <!-- Modal content-->
                        <div class="modal-content">
                            <div class="modal-header">
                                <h4 class="modal-title" style="color:{{text_color}};"> Sort </i></h4>
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                            </div>
                            <div class="modal-body">
                                <div class="row" style="min-height=100px; max-height:400px; overflow-y: scroll;">
                                    <div class="col-lg-12">
                                        <div id="sorting-flight2">

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="filter-search-flight" id="filter-search-flight">
                    <div style="background-color:white; padding:10px; margin-top:20px; border:1px solid #cdcdcd" id="filter">

                    </div>
                </div>
            </div>
            <div class="col-lg-9" style="margin-top:10px;">
                <div class="row sorting-search-flight" id="sorting-search-flight">
                    <div class="col-lg-12">
                        <div id="sorting-flight" style="margin-bottom:15px; margin-top:10px;">

                        </div>
                    </div>
                </div>
                <div class="row">

                    <div class="col-lg-12">
                        <div class="row" style="padding-top:10px;">
                            <div class="col-lg-12" id="insurance_result"></div>
                        </div>

                        <div id="pagination-container" style="margin-bottom:10px; display:none;"></div>

                        <div id="loading-search-insurance" style="margin-bottom:20px;">
                            <div class="col-lg-12">
                                <div class="center-div">
                                    <div>
                                        <img src="{{static_path}}img/loading-screen-white.gif" alt="Loading Screen" style="height:25px; width:25px;"/>
                                    </div>
                                </div>
                                <div style="text-align:center">
                                    <span style="font-size:18px; font-weight:bold;">PLEASE WAIT ... </span>
                                </div>
                            </div>
                        </div>
                        <div class="row" id="insurance_ticket">

                        </div>
                        <div id="pagination-container2" style="margin-bottom:10px;margin-top:15px; display:none;"></div>

                    </div>
                </div>
            </div>
        </div>
        <form action="{% url 'tt_website_rodextrip:insurance_passenger'%}" id="insurance_next" class="form-wrap" method="post">
            {% csrf_token %}
            <input type="hidden" id="data_insurance" name="data_insurance"/>
            <input type="hidden" id="time_limit_input" name="time_limit_input" />
            <input type="hidden" id="signature" name="signature" />
        </form>
    </div>
</section>

{% include 'tt_website_rodextrip/footer.html' %}

<script>

    $(document).ready(function () {
        breadcrumb_create("insurance", 2, 0);
        $('.js-example-basic-single').select2();
        insurance_signin();
        try{
            document.getElementById("balance_search").innerHTML = document.getElementById("balance").innerHTML;
        }catch(err){}
        try{
            document.getElementById("credit_search").innerHTML = document.getElementById("credit_limit").innerHTML;
        }catch(err){}
        $(window).scroll(function() {
            if ($(this).scrollTop() >= 66) {
                if ($(window).width() >= 992){
                   {% if username.co_user_login != 'agent_b2c' %}
                   document.getElementById("info_user_search").style.display = "block";
                   {% endif %}
                   try{
                       document.getElementById("balance_search").innerHTML = document.getElementById("balance").innerHTML;
                   }catch(err){}
                   try{
                       document.getElementById("credit_search").innerHTML = document.getElementById("credit_limit").innerHTML;
                   }catch(err){}
                }else{
                   {% if username.co_user_login != 'agent_b2c' %}
                   document.getElementById("info_user_search").style.display = "none";
                   {% endif %}
                }
            }else{
                {% if username.co_user_login != 'agent_b2c' %}
                document.getElementById("info_user_search").style.display = "none";
                {% endif %}
            }
        });

        var insurance_autocomplete = new autoComplete({
            selector: '#insurance_query',
            minChars: 1,
            cache: false,
            delay:0,
            source: function(term, suggest){
                insurance_search_autocomplete(term,suggest);

            },
            onSelect: function(e, term, item){
                $("#insurance_query").trigger("blur");
            }
        });
        $("#insurance_search_form").bind("keypress", function(e) {
            if (e.keyCode == 13) {
                return false;
            }
        });
    });
</script>

{% endblock %}
