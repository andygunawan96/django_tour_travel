{% extends 'tt_website_skytors/template_website_booking.html' %}
{% load i18n %}
{% load static from staticfiles %}
{% block content %}
<!--<script src="{{ static_path }}js/webservice_token.js"></script>-->
<script src="{{ static_path }}js/daterangepicker.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/moment.min.js?version={{javascript_version}}"></script>
<!--<script src="{{ static_path }}vendor/jquery/jquery-3.2.1.min.js?version={{javascript_version}}"></script>-->
<script src="{{ static_path }}js/webservice_token.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/hotel_javascript.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/webservice_hotel.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/moment.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/agent_javascript.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/webservice_agent.js?version={{javascript_version}}"></script>

<script>
    static_path_url_server = '{{static_path_url_server}}'
    signature = `{{signature}}`;
    $(document).ready(function() {
        $('#asdasd').datepicker({
            'format': 'd M yyyy',
            'todayHighlight': true,
            'autoclose': true
        });
    });
    city_id = {{response.location.city_id}};
    time_limit = {{time_limit}};
    session_time_limit();
    facilities = `{{response.facilities}}`;
    facilities = facilities.replace(/&#39;/g, '"');
    facilities = facilities.replace(/&quot;/g, '"');
    facilities = facilities.replace(/False/g, 'false');
    facilities = facilities.replace(/True/g, 'true');
    hotel_facility_request(facilities);
</script>

{% include 'tt_website_skytors/header.html' %}
{% include 'tt_website_skytors/loading_screen.html' %}
<section class="destinations-area" style="padding-top:30px; padding-bottom:40px; z-index:1;">
    <div class="container">
        <div class="row align-items-center justify-content-between d-flex">
            <div class="col-lg-12" id="breadcrumbs_create" style="padding-bottom:15px;">

            </div>
        </div>
        <div class="row" style="padding-bottom:15px;">
            <div class="col-lg-3 col-md-6 col-sm-6 col-xs-6" style="padding-top:10px;">
                <span style="font-size:14px; font-weight:600;">Session Time <span style="font-size:16px; font-weight:700; color:#f15a22;" id="session_time"> </span></span>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6 col-xs-6" style="padding-top:10px;">
                <span style="font-size:14px; font-weight:600;">Elapsed Time <span style="font-size:16px; font-weight:700; color:#f15a22;" id="elapse_time"> </span></span>
            </div>
        </div>

        <div class="row" style="position:sticky;top: 66px;z-index: 24;">
            <div class="col-lg-12">
                <div class="box-sticky-hotel" style="padding-right:0px;">
                    <button class="content-hotel primary-btn-sticky-hotel" type="button" id="information-hotel">Hotel Description</button>
                    <button class="content-hotel primary-btn-sticky-hotel" type="button" id="facility-hotel">Facility</button>
                    <button class="content-hotel primary-btn-sticky-hotel" type="button" id="location-hotel">Location Info</button>
                    <button class="content-hotel primary-btn-sticky-hotel" type="button" id="select-room-hotel">Select Room</button>

                    <button class="myticket_static_detail" data-toggle="modal" data-target="#myModalCopyHotel" onclick="get_checked_copy_result_room();" style="margin: 8px;">
                        <span style="color:white; font-size:14px;"><span id="badge-copy-notif">0</span> Copy Selected <i class="fas fa-copy"></i></span>
                    </button>
                </div>
            </div>
        </div>
        <form action="{% url 'tt_website_skytors:hotel_passenger' %}" id="goto_passenger" method="POST" style="padding:15px 15px 0px 15px;">
            {% csrf_token %}
            <div class="row">
                <div class="col-lg-12 div-information-hotel" style="background:white; margin-bottom:30px; padding-top:20px; padding-bottom:20px; border:1px solid #cdcdcd; border-radius:3px;">
                    <div class="row">
                        <div class="modal fade" id="openImage" role="dialog" style="background:rgba(250,250,250,1);">
                            <div class="modal-dialog">
                                <!-- Modal content-->
                                <div class="modal-content" style="background-color:transparent; border:unset;">
                                    <div class="modal-header" style="background-color:transparent; border-bottom:unset;">
                                        <button type="button" class="close" data-dismiss="modal" style="color:black;">&times;</button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="col-lg-12">
                                            <div class="row">
                                                <div class="col-lg-12" style="margin-bottom:15px;">
                                                    <div class="owl-carousel-hotel-img-modal owl-theme">
                                                        {% for i in response.images %}
                                                        <div class="item" style="cursor:zoom-in; float:none; display:inline-block;">
                                                            <img class="img-fluid zoom-img" src="{{i.url}}" style="margin: auto; max-height:500px;" alt="">
                                                        </div>
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                                <div class="col-lg-12" style="margin-bottom:15px; text-align:right;">
                                                    <h5 style="color:black;" id="total_image_hotel-modal"></h5>
                                                </div>
                                                <div class="col-lg-12">
                                                    <div class="owl-carousel-hotel-modal owl-theme">
                                                        {% for i in response.images %}
                                                        <div class="item" style="cursor:pointer;">
                                                            <img class="img-fluid" src="{{i.url}}" style="max-width:100%; height:90px;">
                                                        </div>
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-12">
                            <span class="name_hotel" style="font-size:22px; font-weight:bold; color:black;">{{response.name}}</span>
                            <input type="hidden" value="{{response.name}}" id="get_name_hotel"/>
                            <span class="rating_hotel" hidden>{{response.rating}}</span>
                            <span>
                                {% for i in rating %}
                                    <i class="fas fa-star" style="color:#FFC44D;"></i>
                                {% endfor %}
                            </span>
                            <br/>
                            <i class="fas fa-map-marker-alt" style="color:#f15a22;"></i>
                            <span class="address_hotel">{% if response.location.address != false %}{{response.location.address}}{% endif %}{% if response.location.city != false %}, {{response.location.city}}{% endif %}{% if response.location.kelurahan != false %}, {{response.location.kelurahan}}{% endif %}{% if response.location.state != false %}, {{response.location.state}}{% endif %}{% if response.location.zipcode != false %}, {{response.location.zipcode}}{% endif %}</span>
                            - <a href="#" style="color:blue; text-decoration: underline;">Show Map</a><br/>
                            <hr/>
                        </div>

                        <div class="col-lg-7" style="margin-bottom:15px;">
                            <div class="row">
                                <div class="col-lg-12">
                                    <input type="hidden" value="{{response.images|length}}" id="length-img"/>
                                    {% if response.images|length > 0 %}
                                    <div class="owl-carousel-hotel-img owl-theme">
                                        {% for i in response.images %}
                                        <div class="item" style="cursor:pointer; float:none;">
                                            <img class="img-fluid" style="max-height:400px; margin-left:50%; transform:translateX(-50%);" src="{{i.url}}" data-toggle="modal" data-target="#openImage" onclick="go_to_owl_carousel({{forloop.counter}}, {{response.images|length}});">
                                        </div>
                                        {% endfor %}
                                    </div>
                                    <h6 style="color:black; text-align:right; padding-top:10px;" id="total_image_hotel">1 of {{response.images|length}}</h6>
                                    {% else %}
                                    <div class="owl-carousel-hotel-img owl-theme">
                                        <div class="item" style="float:none; display:inline-block; border:1px solid #cdcdcd;">
                                            <img class="img-fluid" src="{{static_path}}/images/no pic/no_image_hotel.jpeg" style="margin: auto; max-height:400px;">
                                        </div>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-5" style="margin-bottom:10px;">
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="row">
                                        {% if response.images|length > 0 %}
                                        {% for i in response.images %}
                                        {% if forloop.counter < 4 %}
                                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-6" style="padding-bottom:15px;">
                                            <img class="img-fluid" src="{{i.url}}" style="width:100%; height:75px; cursor:pointer;" data-toggle="modal" data-target="#openImage" onclick="go_to_owl_carousel({{forloop.counter}}, {{response.images|length}});">
                                        </div>
                                        {% elif forloop.counter == 4%}
                                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-6" style="padding-bottom:15px;">
                                            <div class="dark-img" style="cursor:pointer;" data-toggle="modal" data-target="#openImage" onclick="go_to_owl_carousel({{forloop.counter}}, {{response.images|length}});">
                                                <img class="img-fluid" src="{{i.url}}" style="width:100%; height:75px;">
                                            </div>
                                            <span class="text-block-img" style="cursor:pointer; color:white; font-size:12px; text-align:center;" data-toggle="modal" data-target="#openImage" onclick="go_to_owl_carousel({{forloop.counter}}, {{response.images|length}});"><i class="fas fa-images" style="font-size:18px;"></i><br/>({{response.images|length}})</span>
                                        </div>
                                        {% endif %}
                                        {% endfor %}
                                        {% else %}
                                        <div class="col-lg-3">
                                            <img class="img-fluid" src="{{static_path}}/images/no pic/no_image_hotel.jpeg" style="max-width:100%; height:75px; border:1px solid #cdcdcd;">
                                        </div>
                                        {% endif %}
                                    </div>
                                    <hr/>
                                </div>
                                <div class="col-lg-12">
                                    <h5>Description</h5>
                                    <hr/>
                                    <p style="text-align: justify; height:250px; overflow: auto;">
                                        {% if response.description != '' %}
                                        {{response.description}}
                                        {% else %}
                                        <i class="fas fa-ban" style="color:red;"></i> <span style="font-weight:500; font-size:14px;">No description.</span>
                                        {% endif %}
                                    </p>
                                </div>
                            </div>
                        </div>
                        <!-- Prepare untuk TripAdvisor Cenius Start-->
                        <!--<div class="col-lg-12" style="padding-bottom:5px;">
                            <h4 style="color:#f15a22;">4.5 Excellent</h4>
                        </div>
                        <div class="col-lg-3">
                            <span style="font-weight:500;"><i class="fa fa-map-marker-alt"></i> Location</span>
                            <br/>
                            <img style="height:20px; width:auto;" src="{{static_path}}img/tripadvisor2.png"/>
                        </div>
                        <div class="col-lg-3">
                            <span style="font-weight:500;"><i class="fa fa-broom"></i> Cleanliness</span>
                            <br/>
                            <img style="height:20px; width:auto;" src="{{static_path}}img/tripadvisor2.png"/>
                        </div>
                        <div class="col-lg-3">
                            <span style="font-weight:500;"><i class="fa fa-concierge-bell"></i> Services</span>
                            <br/>
                            <img style="height:20px; width:auto;" src="{{static_path}}img/tripadvisor2.png"/>
                        </div>
                        <div class="col-lg-3">
                            <span style="font-weight:500;"><i class="fa fa-hand-holding"></i> Value</span>
                            <br/>
                            <img style="height:20px; width:auto;" src="{{static_path}}img/tripadvisor2.png"/>
                        </div> -->
                        <!-- Prepare untuk TripAdvisor Cenius END -->
                    </div>
                </div>

                <div class="col-lg-12 div-facility-hotel" style="background:white; margin-bottom:30px; padding-top:20px; padding-bottom:20px; border:1px solid #cdcdcd; border-radius:3px;">
                    <h4>Facility</h4>
                    <hr/>
                    <div id="js_image_facility" class="row">

                    </div>
                </div>

                <div class="col-lg-12 div-location-hotel" style="background:white; margin-bottom:30px; padding-top:20px; padding-bottom:20px; border:1px solid #cdcdcd; border-radius:3px;">
                    <h4>Location Info</h4>
                    <hr/>
                    <i class="fas fa-map-marker-alt" style="color:#f15a22;"></i>
                    <span style="font-size:14px; font-weight:500;">{% if response.location.address != false %}{{response.location.address}}{% endif %}{% if response.location.city != false %}, {{response.location.city}}{% endif %}{% if response.location.kelurahan != false %}, {{response.location.kelurahan}}{% endif %}{% if response.location.state != false %}, {{response.location.state}}{% endif %}{% if response.location.zipcode != false %}, {{response.location.zipcode}}{% endif %}</span>
                </div>

                <div class="col-lg-12 div-select-room-hotel" style="background:white; margin-bottom:30px; padding-top:20px; padding-bottom:20px; border:1px solid #cdcdcd; border-radius:3px;">
                    <div class="row">
                        <div class="col-lg-12">
                            <h4>Room</h4>
                            <hr/>
                        </div>

                        <div class="col-lg-7">
                            <div class="banner-right">
                                <div class="row form-wrap" style="padding:0px !important;">
                                    <div class="col-lg-12" style="text-align:left;padding-bottom:5px;">
                                        <h6>Change Schedule</h6>
                                    </div>
                                    <div class="col-lg-12">
                                        <span style="float:left;"><i class="fas fa-calendar-alt"></i> Check In - Check Out</span>
                                        <div class="input-container-search-ticket">

                                            <input class="form-control" type="text" name="hotel_checkin_checkout" id="hotel_checkin_checkout" placeholder="Check-In - Check-out Date " value="{{check_in}} - {{check_out}}" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Check-In - Check-out Date '" autocomplete="off" readonly onchange="hotel_detail_request(`{{response.external_code}}`);"/>
                                            <i class="fas fa-moon icon-search-ticket" id="total_night_search" style="border: 1px solid #cdcdcd;">1</i>

                                            <!--<input class="form-control" type="hidden" name="checkin_date" id="checkin_date" placeholder="Check-In Date " onfocus="this.placeholder = ''" onblur="this.placeholder = 'Check-in Date '" autocomplete="off" value="{{check_in}}"  onchange="change_date('checkin');"/>-->
                                            <!--<input class="form-control" type="hidden" name="checkout_date" id="checkout_date" placeholder="Check-In Date " onfocus="this.placeholder = ''" onblur="this.placeholder = 'Check-in Date '" autocomplete="off" value="{{check_out}}" onchange="change_date('checkout');"/>-->
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row" id="loading-detail-hotel">
                                <div class="col-lg-12">
                                    <div class="center-div">
                                        <div>
                                            <img src="{{static_path}}img/loading-screen-white.gif" style="height:25px; width:25px;"/>
                                        </div>
                                    </div>
                                    <div style="text-align:center">
                                        <span style="font-size:18px; font-weight:bold;">PLEASE WAIT ... </span>
                                    </div>
                                </div>
                            </div>
                            <div id="select_copy_all">

                            </div>
                            <div id="detail_room_pick">

                            </div>
                        </div>

                        <div class="col-lg-5">
                            <div class="row" style="padding:0px 15px 15px 15px;">
                                <div class="col-lg-12" style="background:white; border:1px solid #cdcdcd; padding-bottom: 15px;">
                                    <h4 style="padding-top:15px;"> Price Detail</h4>
                                    <hr/>
                                    <h5 id="product_title">{{response.name}}</h5>
                                    <hr/>
                                    <div style="padding-top:10px;" id="hotel_detail_table">

                                    </div>
                                    <div id="hotel_detail_button">

                                    </div>
                                    <div style="padding-bottom:10px;" id="not_room_select">
                                        <h6>Please select room first</h6>
                                    </div>
                                </div>

                                <input type="hidden" id="hotel_detail_send" name="hotel_detail_send"/>
                                <textarea id="data_copy2" name="data_copy2" rows="4" hidden></textarea>
                            </div>
                            <div id="data_id">

                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-12">
                    <div class="modal fade" id="myModalCopyHotel" role="dialog">
                        <div class="modal-dialog">
                            <!-- Modal content-->
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h4 class="modal-title" style="color:white;"> List Copy Hotel <i class="fas fa-copy"></i></i></h4>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <div class="row" id="choose-hotel-copy">
                                        <div class="col-lg-12">
                                            <h6>Please choose your room want to copy!</h6>
                                        </div>
                                    </div>
                                    <div id="show-list-copy-hotel">

                                    </div>
                                    <textarea id="data_copy" name="data_copy" rows="4" hidden></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <input type="hidden" id="time_limit_input" name="time_limit_input" />
        </form>
    </div>
</section>
{% include 'tt_website_skytors/footer.html' %}


<script>
    var myIndex = 0;

    $(function() {
      breadcrumb_create("hotel", 3, 0);
      $(window).scroll(function() {
        if($(this).scrollTop()>=$('.div-information-hotel').position().top-130 && $(this).scrollTop()<$('.div-facility-hotel').position().top-130){
            active_sticky_hotel("information");
        }
        else if($(this).scrollTop()>=$('.div-facility-hotel').position().top-130 && $(this).scrollTop()<$('.div-location-hotel').position().top-130){
            active_sticky_hotel("facility");
        }
        else if($(this).scrollTop()>=$('.div-location-hotel').position().top-130 && $(this).scrollTop()<$('.div-select-room-hotel').position().top-130){
            active_sticky_hotel("location");
        }
        else if($(this).scrollTop()>=$('.div-select-room-hotel').position().top-130){
            active_sticky_hotel("select");
        }
        //else if($(this).scrollTop()>=$('.div-select-room-hotel').position().top-130 && $(this).scrollTop()<$('.div-review-hotel').position().top-130){
        //    active_sticky_hotel("select");
        //}
        //else if($(this).scrollTop()>=$('.div-review-hotel').position().top-130){
        //    active_sticky_hotel("review");
        //}
        else if($(this).scrollTop() < $('.div-information-hotel').position().top){
            $(".content-hotel").removeClass("sticky-hotel-active");
        }
      });
      var oneDay = 24*60*60*1000;
      var firstDate = new Date(`{{check_in}}`);
      var secondDate = new Date(`{{check_out}}`);
      var diffDays = Math.round(Math.abs((firstDate.getTime() - secondDate.getTime())/(oneDay)));
      $("#total_night_search").text(diffDays);

      $('input[name="hotel_checkin_checkout"]').daterangepicker({
          singleDatePicker: false,
          autoUpdateInput: true,
          opens: 'center',
          startDate: firstDate,
          endDate: secondDate,
          minDate: moment().subtract(-1, 'days'),
          maxDate: moment().subtract(-366, 'days'),
          showDropdowns: true,
          locale: {
              format: 'DD MMM YYYY',
          }
      });
      hotel_detail_request(`{{response.external_code}}`);
      $('input[name="hotel_checkin_checkout"]').on('apply.daterangepicker', function(ev, picker) {
          $(this).val(picker.startDate.format('DD MMM YYYY') + ' - ' + picker.endDate.format('DD MMM YYYY'));
            var oneDay = 24*60*60*1000;
            var firstDate = new Date(picker.startDate.format('DD MMM YYYY'));
            var secondDate = new Date(picker.endDate.format('DD MMM YYYY'));

            var diffDays = Math.round(Math.abs((firstDate.getTime() - secondDate.getTime())/(oneDay)));
            $("#total_night_search").text(diffDays);
            change_date('checkin');
        });
    });

    function carousel() {
      var i;
      var x = document.getElementsByClassName("mySlides");
      for (i = 0; i < x.length; i++) {
        x[i].style.display = "none";
      }
      myIndex++;
      if (myIndex > x.length) {myIndex = 1}
      x[myIndex-1].style.display = "block";
      setTimeout(carousel, 5000); // Change image every 2 seconds
    }

    function change_date(type){
        $('#loading-detail-hotel').show();
        if(type == 'checkin'){
            change_date_hotel('checkin');
            hotel_detail(`{{response.external_code}}`);
        }else{
            change_date_hotel('checkout');
            hotel_detail(`{{response.external_code}}`);
        }
    }

    function change_date_hotel(type){
        if(type == 'checkin'){
            var date = moment(document.getElementById('hotel_checkin').value);
            date = date.add(1, 'days');
            if(document.getElementById('hotel_checkout').value == '' || moment(document.getElementById('hotel_checkin').value) >= moment(document.getElementById('hotel_checkout').value))
                document.getElementById('hotel_checkout').value = date._d.toString().split(' ')[2]+' '+date._d.toString().split(' ')[1]+' '+date._d.toString().split(' ')[3];
        }else{
            if(moment(document.getElementById('hotel_checkin').value) >= moment(document.getElementById('hotel_checkout').value)){
            }
        }
    }
</script>

{% endblock %}


<!--<div style="background-color:#f15a22;">-->
<!--    <ul class="nav nav-tabs" id="myTab" role="tablist">-->
<!--        <li class="nav-item">-->
<!--            <a class="nav-link active" id="facilities-tab" data-toggle="tab" href="#facilities" role="tab" aria-controls="facilities" aria-selected="true">-->
<!--                <span style="color:white;"> Facilities </span>-->
<!--            </a>-->
<!--        </li>-->
<!--        <li class="nav-item">-->
<!--            <a class="nav-link" id="description-tab" data-toggle="tab" href="#description" role="tab" aria-controls="description" aria-selected="false">-->
<!--                <span style="color:white;"> Description </span>-->
<!--            </a>-->
<!--        </li>-->
<!--    </ul>-->
<!--</div>-->

<!--<div class="tab-content" id="myTabContent">-->
<!--    <div class="tab-pane fade show active" id="facilities" role="tabpanel" aria-labelledby="facilities-tab" style="padding:10px; border-left:1px solid black; border-bottom:1px solid black; border-right:1px solid black; max-height: 410px; overflow-y: auto;">-->
<!--        <span>-->
<!--            {% for facility in response.facilities %}-->
<!--            {{facility.facility_name.facility_name}}<br/>-->
<!--            {% endfor %}-->
<!--        </span>-->
<!--    </div>-->
<!--    <div class="tab-pane fade" id="description" role="tabpanel" aria-labelledby="description-tab" style="padding:10px; border-left:1px solid black; border-bottom:1px solid black; border-right:1px solid black; max-height: 410px; overflow-y: auto;">-->
<!--        <p style="text-align: justify;">-->
<!--            {% if response.description != '' %}-->
<!--            {{response.description}}-->
<!--            {% else %}-->
<!--            No Description-->
<!--            {% endif %}-->
<!--        </p>-->
<!--    </div>-->
<!--</div>-->