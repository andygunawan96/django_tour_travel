{% extends 'tt_website_skytors/template_website_booking.html' %}
{% load i18n %}
{% load static from staticfiles %}
{% block content %}
<!--<script src="{{ static_path }}js/webservice_token.js"></script>-->
<script src="{{ static_path }}js/daterangepicker.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/moment.min.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}vendor/jquery/jquery-3.2.1.min.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/webservice_token.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/hotel_javascript.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/webservice_hotel.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/moment.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/agent_javascript.js?version={{javascript_version}}"></script>

<script src="{{ static_path }}js/webservice_agent.js?version={{javascript_version}}"></script>


<script>
    $(document).ready(function() {
        $('#asdasd').datepicker({
            'format': 'd M yyyy',
            'todayHighlight': true,
            'autoclose': true
        });
    });
    city_id = {{response.location.city_id}};
</script>

{% include 'tt_website_skytors/header.html' %}
<section class="destinations-area" style="padding-top:30px; padding-bottom:40px; z-index:1;">
    <div class="container">
        <div class="row" style="padding-bottom:15px;">
            <div class="col-lg-12" style="margin-top:10px;">
                <ul class="progressbar">
                    <li class="active" onclick="location.href='{% url 'tt_website_skytors:index'%}';" style="cursor:pointer;"><span>Home <i class="fas fa-home"></i></span></li>
                    <li class="current"><span>Search <i class="fas fa-search"></i></span></li>
                    <li><span>Passenger <i class="fas fa-users"></i></span></li>
                    <li><span>Book <i class="fas fa-book-open"></i></span></li>
                    <li><span>Issued <i class="fas fa-check-circle"></i></span></li>
                </ul>
            </div>
        </div>

        <div class="row" style="position:sticky;top: 66px;z-index: 814;">
            <div class="col-lg-12">
                <div class="box-sticky-hotel">
                    <button class="primary-btn-sticky-hotel" type="button" id="information-hotel">Hotel Description</button>
                    <button class="primary-btn-sticky-hotel" type="button" id="facility-hotel">Facility</button>
                    <button class="primary-btn-sticky-hotel" type="button" id="select-room-hotel">Room</button>
                </div>
            </div>
        </div>
        <form action="{% url 'tt_website_skytors:hotel_passenger' %}" id="goto_passenger" method="POST" style="background:white; padding: 15px; border:1px solid #cdcdcd;">
            {% csrf_token %}
            <div class="row">
                <div class="col-lg-12 div-information-hotel" style="background:white; padding-bottom:15px;">
                    <div class="row">
                        <div class="col-lg-12">
                            <span style="font-size:22px; font-weight:bold; color:black;">{{response.name}}</span>
                            <span>
                                <i class="fas fa-star" style="color:#FFC44D;"></i>
                                <i class="fas fa-star" style="color:#FFC44D;"></i>
                                <i class="fas fa-star" style="color:#FFC44D;"></i>
                                <i class="fas fa-star" style="color:#FFC44D;"></i>
                                <i class="fas fa-star" style="color:#FFC44D;"></i>
                            </span>
                            <br/>
                            <span>
                                <i class="fas fa-map-marker-alt" style="color:#f15a22;"></i>
                                {% if response.location.address != False %}
                                {{response.location.address}}
                                {% endif %}
                                {% if response.location.city != False %}
                                {{response.location.city}}
                                {% endif %}
                                {% if response.location.kelurahan != False %}
                                {{response.location.kelurahan}}
                                {% endif %}
                                {% if response.location.state != False %}
                                {{response.location.state}}
                                {% endif %}
                                {% if response.location.zipcode != False %}
                                {{response.location.zipcode}}
                                {% endif %}

                                - <a href="#" style="color:blue; text-decoration: underline;">Show Map</a>
                            </span>
                            <hr/>
                        </div>

                        <div class="col-lg-7" style="margin-bottom:15px;">
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="owl-carousel-hotel-img owl-theme">
                                        {% for i in response.images %}
                                        <div class="item" style="cursor:zoom-in; float:none; display:inline-block;">
                                            <img class="img-fluid zoom-img" src="{{i.url}}" style="margin: auto; width:auto; max-height:400px;" alt="">
                                        </div>
                                        {% endfor %}
                                    </div>
                                </div>
                                <div class="col-lg-12">
                                    <div class="owl-carousel-hotel owl-theme">
                                        {% for i in response.images %}
                                        <div class="item" style="cursor:pointer;">
                                            <img class="img-fluid" src="{{i.url}}" style="max-width:100%; height:75px;">
                                        </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-5" style="margin-bottom:10px;">
                            <h4>Description</h4>
                            <hr/>
                            <p style="text-align: justify;">
                                {% if response.description != '' %}
                                {{response.description}}
                                {% else %}
                                No Description
                                {% endif %}
                            </p>
                        </div>
                    </div>
                </div>

                <div class="col-lg-12 div-facility-hotel" style="background:#F5F5F5; padding-top:40px; padding-bottom:40px;">
                    <h4>Facility</h4>
                    <hr/>
                    <table style="width:100%;">
                        <tr>
                            <td style="width:25%;"><i class="fas fa-circle"></i> Wi-Fi in designated areas</td>
                            <td style="width:25%;"><i class="fas fa-circle"></i> Airport shuttle</td>
                            <td style="width:25%;"><i class="fas fa-circle"></i> Airport pickup service</td>
                            <td style="width:25%;"><i class="fas fa-circle"></i> Restaurant</td>
                        </tr>
                        <tr>
                            <td style="width:25%;"><i class="fas fa-circle"></i> Caf√©</td>
                            <td style="width:25%;"><i class="fas fa-circle"></i> Bar</td>
                            <td style="width:25%;"><i class="fas fa-circle"></i> Non-smoking floor</td>
                            <td style="width:25%;"><i class="fas fa-circle"></i> Currency exchange</td>
                        </tr>
                    </table>

                    <!--                    <span>-->
                    <!--                        {% for facility in response.facilities %}-->
                    <!--                        {{facility.facility_name.facility_name}}<br/>-->
                    <!--                        {% endfor %}-->
                    <!--                    </span>-->
                </div>

                <div class="col-lg-12 div-select-room-hotel" style="padding-top:40px; padding-bottom:40px;">
                    <div class="row">
                        <div class="col-lg-12">
                            <h4>Room</h4>
                            <hr/>

                        </div>

                        <div class="col-lg-8">
                            <div class="banner-right">
                                <div class="row form-wrap" style="padding:0px !important;">
                                    <div class="col-lg-12" style="text-align:left;margin-bottom:5px;">
                                        <h4>Change Schedule</h4>
                                    </div>
                                    <div class="col-lg-12">
                                        <span style="float:left;"><i class="fas fa-calendar-alt"></i> Check-in - Check-out</span>
                                        <div class="input-container-search-ticket">

                                            <input class="form-control" type="text" name="hotel_checkin_checkout" id="hotel_checkin_checkout" placeholder="Check-In - Check-out Date " value="{{check_in}} - {{check_out}}" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Check-In - Check-out Date '" autocomplete="off" readonly/>
                                            <i class="fas fa-moon icon-search-ticket" id="total_night_search" style="padding-right:40px; border-right:1px solid #F0F0F0;">1</i>

                                            <input class="form-control" type="hidden" name="checkin_date" id="checkin_date" placeholder="Check-In Date " onfocus="this.placeholder = ''" onblur="this.placeholder = 'Check-in Date '" autocomplete="off" value="{{checkin_date}}"  onchange="change_date('checkin');"/>
                                            <input class="form-control" type="hidden" name="checkout_date" id="checkout_date" placeholder="Check-In Date " onfocus="this.placeholder = ''" onblur="this.placeholder = 'Check-in Date '" autocomplete="off" value="{{checkout_date}}" onchange="change_date('checkout');"/>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row" id="loading-detail-hotel">
                                <div class="col-lg-12">
                                    <div class="sk-circle">
                                        <div class="sk-circle1 sk-child"></div>
                                        <div class="sk-circle2 sk-child"></div>
                                        <div class="sk-circle3 sk-child"></div>
                                        <div class="sk-circle4 sk-child"></div>
                                        <div class="sk-circle5 sk-child"></div>
                                        <div class="sk-circle6 sk-child"></div>
                                        <div class="sk-circle7 sk-child"></div>
                                        <div class="sk-circle8 sk-child"></div>
                                        <div class="sk-circle9 sk-child"></div>
                                        <div class="sk-circle10 sk-child"></div>
                                        <div class="sk-circle11 sk-child"></div>
                                        <div class="sk-circle12 sk-child"></div>
                                    </div>
                                    <div style="text-align:center"><h6>PLEASE WAIT</h6></div>
                                </div>
                            </div>
                            <div id="detail_room_pick">

                            </div>
                        </div>

                        <div class="col-lg-4">
                            <div id="ticket_price">
                                <div class="row" style="padding:15px;">
                                    <div class="col-lg-12" style="background-color:#f15a22; padding:5px;">
                                        <center>
                                            <span style="color:white; font-size:16px;"> Price Detail <i class="fas fa-money-bill-wave"></i></span>
                                        </center>
                                    </div>
                                    <div class="col-lg-12" style="border:1px solid #cdcdcd; padding-bottom: 15px;">
                                        <h5 id="product_title" style="padding-top:10px;">{{response.name}}</h5>
                                        <hr/>
                                        <div style="padding-top:10px;" id="hotel_detail_table">

                                        </div>
                                        <div style="padding-bottom:10px;" id="not_room_select">
                                            <h6>Please select room first</h6>
                                        </div>
                                    </div>

                                    <input type="hidden" id="hotel_detail_send" name="hotel_detail_send"/>
                                </div>
                            </div>
                            <div id="data_id">

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </form>
    </div>
</section>
{% include 'tt_website_skytors/footer.html' %}

<script>
    hotel_detail(`{{response.external_code}}`);
    var myIndex = 0;

    $(function() {
      var oneDay = 24*60*60*1000;
      var firstDate = new Date($("#hotel_checkin").val());
      var secondDate = new Date($("#hotel_checkout").val());
      var diffDays = Math.round(Math.abs((firstDate.getTime() - secondDate.getTime())/(oneDay)));
      $("#total_night_search").text(diffDays);

      $('input[name="hotel_checkin_checkout"]').daterangepicker({
          singleDatePicker: false,
          autoUpdateInput: true,
          opens: 'center',
          startDate: moment().subtract(-1, 'days'),
          endDate: moment().subtract(-2, 'days'),
          minDate: moment().subtract(-1, 'days'),
          maxDate: moment().subtract(-366, 'days'),
          showDropdowns: true,
          locale: {
              format: 'DD MMM YYYY',
          }
      });

      $('input[name="hotel_checkin_checkout"]').on('apply.daterangepicker', function(ev, picker) {
          $(this).val(picker.startDate.format('DD MMM YYYY') + ' - ' + picker.endDate.format('DD MMM YYYY'));
            $("#hotel_checkin").val(picker.startDate.format('DD MMM YYYY'));
            $("#hotel_checkout").val(picker.endDate.format('DD MMM YYYY'));

            var oneDay = 24*60*60*1000;
            var firstDate = new Date($("#hotel_checkin").val());
            var secondDate = new Date($("#hotel_checkout").val());

            var diffDays = Math.round(Math.abs((firstDate.getTime() - secondDate.getTime())/(oneDay)));
            $("#total_night_search").text(diffDays);
            change_date('checkin');
        });
    });

    function carousel() {
      var i;
      var x = document.getElementsByClassName("mySlides");
      for (i = 0; i < x.length; i++) {
        x[i].style.display = "none";
      }
      myIndex++;
      if (myIndex > x.length) {myIndex = 1}
      x[myIndex-1].style.display = "block";
      setTimeout(carousel, 5000); // Change image every 2 seconds
    }

    function change_date(type){
        $('#loading-detail-hotel').show();
        if(type == 'checkin'){
            change_date_hotel('checkin');
            hotel_detail(`{{response.external_code}}`);
        }else{
            change_date_hotel('checkout');
            hotel_detail(`{{response.external_code}}`);
        }
    }

    function change_date_hotel(type){
        if(type == 'checkin'){
            var date = moment(document.getElementById('hotel_checkin').value);
            date = date.add(1, 'days');
            if(document.getElementById('hotel_checkout').value == '' || moment(document.getElementById('hotel_checkin').value) >= moment(document.getElementById('hotel_checkout').value))
                document.getElementById('hotel_checkout').value = date._d.toString().split(' ')[2]+' '+date._d.toString().split(' ')[1]+' '+date._d.toString().split(' ')[3];
        }else{
            if(moment(document.getElementById('hotel_checkin').value) >= moment(document.getElementById('hotel_checkout').value)){
            }
        }
    }
</script>

{% endblock %}


<!--<div style="background-color:#f15a22;">-->
<!--    <ul class="nav nav-tabs" id="myTab" role="tablist">-->
<!--        <li class="nav-item">-->
<!--            <a class="nav-link active" id="facilities-tab" data-toggle="tab" href="#facilities" role="tab" aria-controls="facilities" aria-selected="true">-->
<!--                <span style="color:white;"> Facilities </span>-->
<!--            </a>-->
<!--        </li>-->
<!--        <li class="nav-item">-->
<!--            <a class="nav-link" id="description-tab" data-toggle="tab" href="#description" role="tab" aria-controls="description" aria-selected="false">-->
<!--                <span style="color:white;"> Description </span>-->
<!--            </a>-->
<!--        </li>-->
<!--    </ul>-->
<!--</div>-->

<!--<div class="tab-content" id="myTabContent">-->
<!--    <div class="tab-pane fade show active" id="facilities" role="tabpanel" aria-labelledby="facilities-tab" style="padding:10px; border-left:1px solid black; border-bottom:1px solid black; border-right:1px solid black; max-height: 410px; overflow-y: auto;">-->
<!--        <span>-->
<!--            {% for facility in response.facilities %}-->
<!--            {{facility.facility_name.facility_name}}<br/>-->
<!--            {% endfor %}-->
<!--        </span>-->
<!--    </div>-->
<!--    <div class="tab-pane fade" id="description" role="tabpanel" aria-labelledby="description-tab" style="padding:10px; border-left:1px solid black; border-bottom:1px solid black; border-right:1px solid black; max-height: 410px; overflow-y: auto;">-->
<!--        <p style="text-align: justify;">-->
<!--            {% if response.description != '' %}-->
<!--            {{response.description}}-->
<!--            {% else %}-->
<!--            No Description-->
<!--            {% endif %}-->
<!--        </p>-->
<!--    </div>-->
<!--</div>-->