{% extends 'tt_website_skytors/template_website_booking.html' %}
{% load i18n %}
{% load static from staticfiles %}
{% block content %}
<!--<script src="{{ static_path }}js/webservice_token.js"></script>-->
<script src="{{ static_path }}js/daterangepicker.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/moment.min.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}vendor/jquery/jquery-3.2.1.min.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/webservice_token.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/hotel_javascript.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/webservice_hotel.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/moment.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/agent_javascript.js?version={{javascript_version}}"></script>

<script src="{{ static_path }}js/webservice_agent.js?version={{javascript_version}}"></script>


<script>
    $(document).ready(function() {
        $('#asdasd').datepicker({
            'format': 'd M yyyy',
            'todayHighlight': true,
            'autoclose': true
        });
    });
    city_id = {{response.location.city_id}};
</script>

<section class="destinations-area" style="padding-top:30px; padding-bottom:40px; z-index:1;">
    <div class="container">
        <div class="row" style="padding-bottom:10px;">
            <div class="col-lg-12" style="margin-top:10px;">
                <div class="breadcrumb-ticket" style="text-align:center;">
                    <a href="{% url 'tt_website_skytors:index'%}" class="active"> Home <i class="fas fa-home"></i></a>
                    <a href="{% url 'tt_website_skytors:hotel_search'%}" class="active"> Search <i class="fas fa-search"></i></a>
                    <a href="#" style="pointer-events: none;"> Booker & Passenger <i class="fas fa-users"></i></a>
                    <a href="#" style="pointer-events: none;"> Review <i class="fas fa-info-circle"></i></a>
                    <a href="#" style="pointer-events: none;"> Booking <i class="fas fa-book-open"></i></a>
                    <a href="#" style="pointer-events: none;"> Issued <i class="fas fa-check-circle"></i></a>
                </div>
            </div>
        </div>
        <form action="{% url 'tt_website_skytors:hotel_passenger' %}" id="goto_passenger" method="POST">
            {% csrf_token %}
            <div class="row" style="padding-top:20px;">
                <div class="col-lg-12 div-information-hotel">
                    <div class="row">
                        <div class="col-lg-12">
                            <span style="font-size:22px; font-weight:bold; color:black;">{{response.name}}</span>
                            <span>
                                <i class="fas fa-star" style="color:#FFC44D;"></i>
                                <i class="fas fa-star" style="color:#FFC44D;"></i>
                                <i class="fas fa-star" style="color:#FFC44D;"></i>
                                <i class="fas fa-star" style="color:#FFC44D;"></i>
                                <i class="fas fa-star" style="color:#FFC44D;"></i>
                            </span>
                            <br/>
                            <span>
                                <i class="fas fa-map-marker-alt" style="color:#f15a22;"></i>
                                {% if response.location.address != False %}
                                {{response.location.address}}
                                {% endif %}
                                {% if response.location.city != False %}
                                {{response.location.city}}
                                {% endif %}
                                {% if response.location.kelurahan != False %}
                                {{response.location.kelurahan}}
                                {% endif %}
                                {% if response.location.state != False %}
                                {{response.location.state}}
                                {% endif %}
                                {% if response.location.zipcode != False %}
                                {{response.location.zipcode}}
                                {% endif %}

                                - <a href="#" style="color:blue; text-decoration: underline;">Show Map</a>
                            </span>
                            <hr/>
                        </div>
                        <div class="col-lg-12">
                            <div class="box-sticky-hotel">
                                <button class="primary-btn-sticky-hotel" type="button" id="information-hotel">Information</button>
                                <button class="primary-btn-sticky-hotel" type="button" id="select-room-hotel">Select Room</button>
                            </div>
                            <hr/>
                        </div>

                        <div class="col-lg-7" style="margin-bottom:15px;">
                            <div class="row">
                                <div class="col-lg-12">

                                    <div class="owl-carousel-hotel-img owl-theme">
                                        {% for i in response.images %}
                                        <div class="item" style="cursor:zoom-in; float:none; display:inline-block;">
                                            <img class="img-fluid zoom-img" src="{{i.url}}" style="margin: auto; width:auto; max-height:325px;" alt="">
                                        </div>
                                        {% endfor %}
                                    </div>
                                </div>
                                <div class="col-lg-12">
                                    <div class="owl-carousel-hotel owl-theme">
                                        {% for i in response.images %}
                                        <div class="item" style="cursor:pointer;">
                                            <img class="img-fluid" src="{{i.url}}" style="max-width:100%; height:75px;">
                                        </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-5" style="margin-bottom:10px;">
                            <div style="background-color:#f15a22;">
                                <ul class="nav nav-tabs" id="myTab" role="tablist">
                                    <li class="nav-item">
                                        <a class="nav-link active" id="facilities-tab" data-toggle="tab" href="#facilities" role="tab" aria-controls="facilities" aria-selected="true">
                                            <span style="color:white;"> Facilities </span>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="description-tab" data-toggle="tab" href="#description" role="tab" aria-controls="description" aria-selected="false">
                                            <span style="color:white;"> Description </span>
                                        </a>
                                    </li>
                                </ul>
                            </div>

                            <div class="tab-content" id="myTabContent">
                                <div class="tab-pane fade show active" id="facilities" role="tabpanel" aria-labelledby="facilities-tab" style="padding:10px; border-left:1px solid black; border-bottom:1px solid black; border-right:1px solid black; max-height: 410px; overflow-y: auto;">
                                    <span>
                                        {% for facility in response.facilities %}
                                        {{facility.facility_name.facility_name}}<br/>
                                        {% endfor %}
                                    </span>
                                </div>
                                <div class="tab-pane fade" id="description" role="tabpanel" aria-labelledby="description-tab" style="padding:10px; border-left:1px solid black; border-bottom:1px solid black; border-right:1px solid black; max-height: 410px; overflow-y: auto;">
                                    <p style="text-align: justify;">
                                        {% if response.description != '' %}
                                        {{response.description}}
                                        {% else %}
                                        No Description
                                        {% endif %}
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr/>
                </div>

                <div class="col-lg-12 div-select-room-hotel">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="banner-right box-date-hotel">
                                <div class="row form-wrap">
                                    <div class="col-lg-12" style="text-align:left;margin-bottom:5px;">
                                        <h4 style="color:white;">Change Schedule</h4>
                                    </div>
                                    <div class="col-lg-12">
                                        <span class="span-search-ticket">Check-in - Check-out</span>
                                        <div class="input-container-search-ticket">
                                            <i class="fas fa-calendar-alt icon-search-ticket"></i>
                                            <input class="form-control" type="text" name="hotel_checkin_checkout" id="hotel_checkin_checkout" placeholder="Check-In - Check-out Date " value="{{check_in}} - {{check_out}}" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Check-In - Check-out Date '" autocomplete="off" readonly/>
                                            <i class="fas fa-moon icon-search-ticket" id="total_night_search" style="padding-right:40px; border-right:1px solid #F0F0F0;">1</i>

                                            <input class="form-control" type="hidden" name="checkin_date" id="checkin_date" placeholder="Check-In Date " onfocus="this.placeholder = ''" onblur="this.placeholder = 'Check-in Date '" autocomplete="off" value="{{check_in}}"  onchange="change_date('checkin');"/>
                                            <input class="form-control" type="hidden" name="checkout_date" id="checkout_date" placeholder="Check-In Date " onfocus="this.placeholder = ''" onblur="this.placeholder = 'Check-in Date '" autocomplete="off" value="{{check_out}}" onchange="change_date('checkout');"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-8">
                            <div class="row" id="loading-detail-hotel">
                                <div class="col-lg-12">
                                    <div class="sk-circle">
                                        <div class="sk-circle1 sk-child"></div>
                                        <div class="sk-circle2 sk-child"></div>
                                        <div class="sk-circle3 sk-child"></div>
                                        <div class="sk-circle4 sk-child"></div>
                                        <div class="sk-circle5 sk-child"></div>
                                        <div class="sk-circle6 sk-child"></div>
                                        <div class="sk-circle7 sk-child"></div>
                                        <div class="sk-circle8 sk-child"></div>
                                        <div class="sk-circle9 sk-child"></div>
                                        <div class="sk-circle10 sk-child"></div>
                                        <div class="sk-circle11 sk-child"></div>
                                        <div class="sk-circle12 sk-child"></div>
                                    </div>
                                    <div style="text-align:center"><h6>PLEASE WAIT</h6></div>
                                </div>
                            </div>
                            <div id="detail_room_pick">

                            </div>
                        </div>

                        <div class="col-lg-4">
                            <div id="ticket_price" style="background-color:white;">
                                <div class="row" style="padding:15px;">
                                    <div class="col-lg-12" style="background-color:#f15a22; padding:5px;">
                                        <center>
                                            <span style="color:white; font-size:16px;">Detail Price</span>
                                            <h6 id="product_title">{{response.name}}</h6>
                                        </center>
                                    </div>
                                    <div class="col-lg-12">
                                        <div style="padding-top:10px;" id="hotel_detail_table">

                                        </div>
                                        <div style="padding-top:10px;" id="not_room_select">
                                            <h6>Please select room first</h6>
                                        </div>
                                    </div>

                                    <input type="hidden" id="hotel_detail_send" name="hotel_detail_send"/>
                                </div>
                            </div>
                            <div id="data_id">

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </form>
    </div>
</section>

<footer class="footer-area section-gap">
    <div class="container">
        <div class="row">
            <div class="col-lg-4 col-md-6 col-sm-6">
                <div class="single-footer-widget">
                    <h6>About RODEX TRIP</h6>
                    <p>
                        PT. Roda Express Sukses Mandiri adalah perusahaan yang bergerak di bidang Tour & Travel dan dikenal dengan nama RODEX TOUR & TRAVEL. Rodex Tour & Travel didirikan pertama kali pada tanggal 09 September 2009 bertempat di sebuah pusat perbelanjaan terkemuka di Surabaya yaitu Mall Pakuwon Trade Center (PTC). Di bawah kepemimpinan Bapak Galuh Suryono Cipto Adi, Rodex Tour & Travel mengalami perkembangan yang signifikan dari tahun ke tahun.
                    </p>
                    <p>
                        Hingga saat ini kami telah memiliki  lebih kurang 1.000 orang reseller yang teregister dan puluhan Cabang Mitra (Citra) yang tersebar di seluruh indonesia.
                    </p>
                </div>
            </div>
            <div class="col-lg-4 col-md-6 col-sm-6">
                <div class="single-footer-widget">
                    <h6>Navigation Links</h6>
                    <div class="row">
                        <div class="col">
                            <ul>
                                <li><a href="#">Home</a></li>
                                <li><a href="#">Feature</a></li>
                                <li><a href="#">Services</a></li>
                                <li><a href="#">Portfolio</a></li>
                            </ul>
                        </div>
                        <div class="col">
                            <ul>
                                <li><a href="#">Team</a></li>
                                <li><a href="#">Pricing</a></li>
                                <li><a href="#">Blog</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-6 col-sm-6">
                <div class="single-footer-widget">
                    <h6>Newsletter</h6>
                    <p>
                        Dapatkan Penawaran Langsung di Inbox Email Anda!
                    </p>
                    <div id="mc_embed_signup">
                        <form target="_blank" action="https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01" method="get" class="subscription relative">
                            <div class="input-group d-flex flex-row">
                                <input name="EMAIL" placeholder="Email Address" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Email Address '" required="" type="email">
                                <button class="btn bb-btn"><span class="lnr lnr-location"></span></button>
                            </div>
                            <div class="mt-10 info"></div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="row footer-bottom d-flex justify-content-between align-items-center">
            <p class="col-lg-8 col-sm-12 footer-text m-0"><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved by RODEX TRIP
                <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
            <div class="col-lg-4 col-sm-12 footer-social">
                <a href="#"><i class="fas fa-facebook-square"></i></a>
                <a href="#"><i class="fas fa-twitter-square"></i></a>
                <a href="#"><i class="fas fa-instagram"></i></a>
            </div>
        </div>
    </div>
</footer>

<script>
    hotel_detail(`{{response.external_code}}`);
    var myIndex = 0;

    $(function() {
      var oneDay = 24*60*60*1000;
      var firstDate = new Date($("#hotel_checkin").val());
      var secondDate = new Date($("#hotel_checkout").val());
      var diffDays = Math.round(Math.abs((firstDate.getTime() - secondDate.getTime())/(oneDay)));
      $("#total_night_search").text(diffDays);

      $('input[name="hotel_checkin_checkout"]').daterangepicker({
          singleDatePicker: false,
          autoUpdateInput: true,
          opens: 'center',
          startDate: moment().subtract(-1, 'days'),
          endDate: moment().subtract(-2, 'days'),
          minDate: moment().subtract(-1, 'days'),
          maxDate: moment().subtract(-366, 'days'),
          showDropdowns: true,
          locale: {
              format: 'DD MMM YYYY',
          }
      });

      $('input[name="hotel_checkin_checkout"]').on('apply.daterangepicker', function(ev, picker) {
          $(this).val(picker.startDate.format('DD MMM YYYY') + ' - ' + picker.endDate.format('DD MMM YYYY'));
            console.log(picker.startDate.format('DD MMM YYYY'));
            $("#hotel_checkin").val(picker.startDate.format('DD MMM YYYY'));
            $("#hotel_checkout").val(picker.endDate.format('DD MMM YYYY'));

            var oneDay = 24*60*60*1000;
            var firstDate = new Date($("#hotel_checkin").val());
            var secondDate = new Date($("#hotel_checkout").val());

            var diffDays = Math.round(Math.abs((firstDate.getTime() - secondDate.getTime())/(oneDay)));
            $("#total_night_search").text(diffDays);
            change_date('checkin');
        });
    });

    function carousel() {
      var i;
      var x = document.getElementsByClassName("mySlides");
      for (i = 0; i < x.length; i++) {
        x[i].style.display = "none";
      }
      myIndex++;
      if (myIndex > x.length) {myIndex = 1}
      x[myIndex-1].style.display = "block";
      setTimeout(carousel, 5000); // Change image every 2 seconds
    }

    function change_date(type){
        $('#loading-detail-hotel').show();
        if(type == 'checkin'){
            change_date_hotel('checkin');
            hotel_detail(`{{response.external_code}}`);
        }else{
            change_date_hotel('checkout');
            hotel_detail(`{{response.external_code}}`);
        }
    }

    function change_date_hotel(type){
        if(type == 'checkin'){
            var date = moment(document.getElementById('hotel_checkin').value);
            date = date.add(1, 'days');
            if(document.getElementById('hotel_checkout').value == '' || moment(document.getElementById('hotel_checkin').value) >= moment(document.getElementById('hotel_checkout').value))
                document.getElementById('hotel_checkout').value = date._d.toString().split(' ')[2]+' '+date._d.toString().split(' ')[1]+' '+date._d.toString().split(' ')[3];
        }else{
            if(moment(document.getElementById('hotel_checkin').value) >= moment(document.getElementById('hotel_checkout').value)){
            }
        }
    }
</script>

{% endblock %}
