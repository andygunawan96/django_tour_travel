{% extends 'tt_website_skytors/template_website_booking.html' %}
{% load i18n %}
{% load static from staticfiles %}
{% block content %}
<!--<script src="{{ static_path }}js/webservice_token.js"></script>-->
<script src="{{ static_path }}vendor/jquery/jquery-3.2.1.min.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/webservice_token.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/activity_javascript.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/webservice_activity.js?version={{javascript_version}}"></script>
<script src="{{ static_path }}js/moment.js?version={{javascript_version}}"></script>
<script>
    locations = [];
    images = [];
    {% for i in response.locations %}
        locations.push({
            'country_name': '{{i.country_name}}',
            'city_name': '{{i.city_name}}',
            'state_name': '{{i.state_name}}'
        })
    {% endfor %}

    {% for i in response.images %}
        images.push({
            'url': '{{i.url}}',
            'path': '{{i.path}}',
        })
    {% endfor %}

    highlights = `{{response.highlights}}`;

    response = {
        'locations':locations,
        'images': images,
        'additionalInfo': `{{response.additionalInfo}}`,
        'uuid': '{{response.uuid}}',
        'highlights': highlights.replace('&#39;', "'"),
        'safety': `{{response.safety}}`,
        'longitude': {{response.longitude}},
        'latitude': {{response.latitude}},
        'provider_id': '{{response.provider_id}}',
        'description': `{{response.description}}`,
        'warnings': `{{response.warnings}}`,
        'priceExcludes': `{{response.priceExcludes}}`,
        'minPax': {{response.minPax}},
        'maxPax': {{response.maxPax}},
        'businessHoursFrom': `{{response.businessHoursFrom}}`,
        'businessHoursTo': `{{response.businessHoursTo}}`,
        'name': '{{response.name}}',
        'itinerary': `{{response.itinerary}}`,
    };
</script>

<script src="{{ static_path }}js/webservice_agent.js"></script>

<style>
    @media only screen and (min-width: 991px) {
        #header_home {
            padding-top: 100px;
        }
    }
    @media only screen and (max-width: 990px) {
        #header_home {
            padding-top: 0px;
        }
    }
</style>

{% include 'tt_website_skytors/header.html' %}
<div class="destinations-area" style="margin-bottom:25px;">
    <div class="container">
        <div class="row" style="padding-bottom:15px;">
            <div class="col-lg-12" style="display:flex; padding-top:15px; padding-left:15px;">
                <div class="breadcrumbs-rdx br-done" onclick="location.href='{% url 'tt_website_skytors:index'%}';">
                    <span class="breadcrumb-rdx-icon br-icon-done"><i class="fas fa-check"></i></span>
                    <span style="padding-left:5px;">Home</span>
                    <span class="br-fa"><i class="fas fa-arrow-right"></i></span>
                </div>
                <div class="breadcrumbs-rdx br-done">
                    <span class="breadcrumb-rdx-icon br-icon-done">2</span>
                    <span style="padding-left:5px;">Search</span>
                    <span class="br-fa"><i class="fas fa-arrow-right"></i></span>
                </div>
                <div class="breadcrumbs-rdx br-active">
                    <span class="breadcrumb-rdx-icon br-icon-active">3</span>
                    <span style="padding-left:5px;">Detail</span>
                    <span class="br-fa"><i class="fas fa-arrow-right"></i></span>
                </div>
                <div class="breadcrumbs-rdx">
                    <span class="breadcrumb-rdx-icon">4</span>
                    <span style="padding-left:5px;">Passenger</span>
                    <span class="br-fa"><i class="fas fa-arrow-right"></i></span>
                </div>
                <div class="breadcrumbs-rdx">
                    <span class="breadcrumb-rdx-icon">5</span>
                    <span style="padding-left:5px;">Issued</span>
                </div>
            </div>
        </div>
        <div class="row full_activity_details">
            <div class="col-lg-12">
                <form method='POST' action="{% url 'tt_website_skytors:activity_passenger'%}" id="go_to_pax" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="row" style="position:sticky;top: 66px;z-index: 814;">
                        <div class="col-lg-12">
                            <div class="box-sticky-hotel">
                                <button class="content-hotel primary-btn-sticky-hotel" type="button" id="information-hotel">Hotel Description</button>
                                <button class="content-hotel primary-btn-sticky-hotel" type="button" id="facility-hotel">Facility</button>
                                <button class="content-hotel primary-btn-sticky-hotel" type="button" id="location-hotel">Location Info</button>
                                <button class="content-hotel primary-btn-sticky-hotel" type="button" id="select-room-hotel">Select Room</button>
                                <button class="content-hotel primary-btn-sticky-hotel" type="button" id="review-hotel">Review</button>
                            </div>
                        </div>
                    </div>
                    <div class="row" style="padding:0px 15px;">
                        <input type="hidden" id="activity_uuid" name="activity_uuid" value="{{response.uuid}}"/>
                        <div class="col-lg-12" style="background:white; border:1px solid #cdcdcd; padding:15px;">
                            <div class="row">
                                <div class="col-lg-12">
                                    <span style="font-size:18px; font-weight:700;">{{response.name}}</span>
                                    <span style="font-size:14px;">
                                <i class="fas fa-star" style="color:#FFC44D;"></i>
                                {{response.reviewAverageScore}} ({{response.reviewCount}})
                            </span>
                                    <br/>
                                    <span style="font-size:13px;">
                                <i class="fas fa-map-marker-alt" style="color:#f15a22;"></i>
                                {% for i in response.locations %}
                                {{i.city_name}}, {{i.country_name}};
                                {% endfor %}
                            </span>
                                    <hr/>
                                </div>
                                <div class="col-lg-7 col-md-7">
                                    {% for i in response.videos %}
                                    <video width="100%" height="360px" style="background:black;" controls autoplay loop>
                                        <source src="{{i.url}}" type="video/mp4">
                                        Your browser does not support the video tag.
                                    </video>
                                    {% endfor %}
                                </div>
                                <div class="col-lg-5 col-md-5">
                                    <div id="activity_carousel" style="object-fit: cover;">
                                        <div class="owl-carousel-activity-img owl-theme">
                                            {% for i in response.images %}
                                            <div class="item" style="background:black;">
                                                <img class="img-fluid" src="{{i.url}}{{i.path}}" alt="" style="display: block; width: 700px; height:360px; object-fit: contain;">
                                            </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top:30px;">
                                <h5 style="padding-bottom:10px;">Choose Product Type: </h5>
                                <div class="input-group-btn" id="ticket_type" data-toggle="buttons" style="width: 100%; white-space: normal;">

                                </div>
                            </div>
                            <div class="row banner-right">
                                <div class="col-lg-7 col-md-7" id="ticket_detail">
                                    <div class="form-wrap" style="padding:0px;">
                                        <div class="row" id="date" style="text-align:left;">

                                        </div>
                                        <div id="loading-detail-activity" style="margin-bottom:20px;">
                                            <div class="col-lg-12">
                                                <div class="sk-circle">
                                                    <div class="sk-circle1 sk-child"></div>
                                                    <div class="sk-circle2 sk-child"></div>
                                                    <div class="sk-circle3 sk-child"></div>
                                                    <div class="sk-circle4 sk-child"></div>
                                                    <div class="sk-circle5 sk-child"></div>
                                                    <div class="sk-circle6 sk-child"></div>
                                                    <div class="sk-circle7 sk-child"></div>
                                                    <div class="sk-circle8 sk-child"></div>
                                                    <div class="sk-circle9 sk-child"></div>
                                                    <div class="sk-circle10 sk-child"></div>
                                                    <div class="sk-circle11 sk-child"></div>
                                                    <div class="sk-circle12 sk-child"></div>
                                                </div>
                                                <div style="text-align:center"><h6>PLEASE WAIT</h6></div>
                                            </div>
                                        </div>
                                        <div class="row" id="event" style="text-align:left;">

                                        </div>
                                        <div class="row" id="pax" style="text-align:left;">

                                        </div>
                                        <div class="row" id="timeslot" style="text-align:left;">

                                        </div>

                                        <div class="row" style="text-align:left;" id="perbooking">

                                        </div>
                                    </div>
                                    <div class="row" style="margin-top:15px;">
                                        <div class="col-lg-6"></div>
                                        <div class="col-lg-6">
                                            <div class="for-show-website" id="activity_detail_next_btn">

                                            </div>
                                        </div>
                                    </div>
                                    <div style="text-align:left;" class="modal fade" id="myModalErrorDetail" role="dialog">
                                        <div class="modal-dialog">
                                            <!-- Modal content-->
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h4 class="modal-title" style="color:white;"><i class="fas fa-search-minus"></i> Oops! Please check your details </i></h4>
                                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                </div>
                                                <div class="modal-body">
                                                    <div class="row">
                                                        <div class="col-lg-12">
                                                            <div style="max-height:300px; overflow-y:auto;">
                                                                <h5><i class="fas fa-times-circle" style="color:red; font-size:24px;"></i> We found a mistake in your data.</h5>
                                                                <br/>
                                                                <span id="show_error_log" style="font-size:15px;">

                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="primary-btn" data-dismiss="modal">OK</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-5 col-md-5" id="ticket_price">
                                    <div style="background-color:white; padding:15px; border:1px solid #cdcdcd;" id="activity_detail">
                                        <h4> Price Detail </h4>
                                        <hr/>
                                        <span id="product_title" style="font-weight: bold;">{{response.name}}</span>
                                        <br/><span id="product_type_title"></span>
                                        <br/><br/>
                                        <div id="activity_detail_table">

                                        </div>
                                    </div>
                                    <br/>
                                    <div class="for-show-mobile" id="activity_detail_next_btn2">

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" style="padding:15px;">
                        <div class="col-lg-12" style="background-color:white; border:1px solid #cdcdcd; margin-top:5px; padding:0;">
                            <ul class="nav nav-tabs-activity" style="text-align:center; margin-bottom:15px;">
                                <li class="li-activity" style="display: inline-block !important; width: 135px; text-align: center; margin: 0px -2px 0px 0px !important;">
                                    <a class="tab-menu-activity active" data-toggle="tab" href="#detail"><i class="fa fa-info-circle" aria-hidden="true" title="details" style="font-size: 18px;"></i><span class="hidden-xs"> Details</span></a>
                                </li>
                                <li class="li-activity" style="display: inline-block !important; width: 135px; text-align: center; margin: 0px -2px 0px 0px !important;">
                                    <a class="tab-menu-activity" data-toggle="tab" href="#rules"><i class="fa fa-exclamation-circle" aria-hidden="true" title="details" style="font-size: 18px;"></i><span class="hidden-xs"> Rules</span></a>
                                </li>
                                <li class="li-activity" style="display: inline-block !important; width: 135px; text-align: center; margin: 0px -2px 0px 0px !important;">
                                    <a class="tab-menu-activity" data-toggle="tab" href="#prices"><i class="fa fa-usd" aria-hidden="true" title="details" style="font-size: 18px;"></i><span class="hidden-xs"> Prices</span></a>
                                </li>
                                <li class="li-activity" style="display: inline-block !important; width: 135px; text-align: center; margin: 0px -2px 0px 0px !important;">
                                    <a class="tab-menu-activity" data-toggle="tab" href="#vouchers"><i class="fa fa-ticket-alt" aria-hidden="true" title="details" style="font-size: 18px;"></i><span class="hidden-xs"> Vouchers</span></a>
                                </li>
                                {% if response.itinerary != ''%}
                                <li class="li-activity" style="display: inline-block !important; width: 135px; text-align: center; margin: 0px -2px 0px 0px !important;">
                                    <a class="tab-menu-activity" data-toggle="tab" href="#price_itinerary"><i class="fa fa-list-ul" aria-hidden="true" title="details" style="font-size: 18px;"></i><span class="hidden-xs"> Price Itinerary</span></a>
                                </li>
                                {% endif %}
                            </ul>
                            <div class="tab-content">
                                <div id="detail" class="tab-pane fade in active show">
                                    {% if response.description != '' %}
                                    <h3 style="padding:0 20px; margin-bottom:10px;">Description</h3>
                                    <p style="padding:0 20px;text-align:justify">{{response.description | safe}}</p>
                                    {% endif %}
                                    {% if response.highlights != '' %}
                                    <h3 style="padding:0 20px; margin-bottom:10px;">Highlights</h3>
                                    <p style="padding:0 20px;text-align:justify">{{response.highlights | safe}}</p>
                                    {% endif %}
                                    {% if response.additionalInfo != '' %}
                                    <h3 style="padding:0 20px; margin-bottom:10px;">Additional Info</h3>
                                    <p style="padding:0 20px;text-align:justify">{{response.additionalInfo | safe}}</p>
                                    {% endif %}
                                </div>
                                <div id="rules" class="tab-pane fade">
                                    {% if response.warnings != '' %}
                                    <h3 style="padding:0 20px; margin-bottom:10px;">Warnings</h3>
                                    <p style="padding:0 20px;text-align:justify">{{response.warnings | safe}}</p>
                                    {% endif %}
                                    {% if response.safety != '' %}
                                    <h3 style="padding:0 20px; margin-bottom:10px;">Safety</h3>
                                    <p style="padding:0 20px;text-align:justify">{{response.safety | safe}}</p>
                                    {% endif %}
                                </div>
                                <div id="prices" class="tab-pane fade">
                                    {% if response.priceIncludes != '' %}
                                    <h3 style="padding:0 20px; margin-bottom:10px;">Price Includes</h3>
                                    <p style="padding:0 20px;text-align:justify">{{response.priceIncludes}}</p>
                                    {% endif %}
                                    {% if response.priceExcludes != '' %}
                                    <h3 style="padding:0 20px; margin-bottom:10px;">Price Excludes</h3>
                                    <p style="padding:0 20px;text-align:justify">{{response.priceExcludes}}</p>
                                    {% endif %}
                                </div>
                                <div id="vouchers" class="tab-pane fade" id="vouchers">
                                    {% if response.voucher_validity != '' %}
                                    <h3 style="padding:0 20px; margin-bottom:10px;">Validity</h3>
                                    <p style="padding:0 20px;text-align:justify">{{response.voucher_validity}}</p>
                                    {% endif %}
                                    {% if response.voucherUse != '' %}
                                    <h3 style="padding:0 20px; margin-bottom:10px;">Voucher Use</h3>
                                    <p style="padding:0 20px;text-align:justify">{{response.voucherUse}}</p>
                                    {% endif %}
                                    {% if response.voucherRedemptionAddress != '' %}
                                    <h3 style="padding:0 20px; margin-bottom:10px;">Voucher Address</h3>
                                    <p style="padding:0 20pxtext-align:justify;">{{response.voucherRedemptionAddress}}</p>
                                    {% endif %}
                                    {% if response.voucherRequiresPrinting != '' %}
                                    <h3 style="padding:0 20px; margin-bottom:10px;">Voucher Print</h3>
                                    <p style="padding:0 20px;text-align:justify">{{response.voucherRequiresPrinting}}</p>
                                    {% endif %}
                                </div>
                                <div id="price_itinerary" class="tab-pane fade">
                                    {% if response.itinerary != '' %}
                                    <h3 style="padding:0 20px; margin-bottom:10px;">Itinerary</h3>
                                    <p style="padding:0 20px; text-align:justify">{{response.itinerary}}</p>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                    <br/>
                    <div id="details_div"></div>
                    <div id="activity_date_div"></div>
                    <div id="data_id">

                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<script>
    $( document ).ready(function() {
        activity_get_detail(`{{response.uuid}}`, `{{response.provider_id}}`);
    });

    var myIndex = 0;

    //gotopax

    function detail_to_passenger_page(){

        text = `
        <input type='hidden' value='`+activity_type_pick+`' name='activity_type_pick'/>
        <input type='hidden' value='`+activity_date_pick+`' name='activity_date_pick'/>
        <input type='hidden' value='`+activity_timeslot+`' name='activity_timeslot'/>
        <input type='hidden' value='`+additional_price+`' name='additional_price'/>
        <input type='hidden' value='`+event_pick+`' name='event_pick'/>`;

        for (pax_check in activity_type[activity_type_pick].skus)
        {
            low_sku_id_check = String(activity_type[activity_type_pick].skus[pax_check].sku_id).toLowerCase();
            try{
                if(document.getElementById(low_sku_id_check + '_passenger').value != 0 )
                    text+=`<input type='hidden' value='`+document.getElementById(low_sku_id_check + '_passenger').value+`' name=low_sku_id_check + '_passenger'/>`;
                else
                    text+=`<input type='hidden' value='0' name=low_sku_id_check + '_passenger'/>`;
            }catch(err){
                text+=`<input type='hidden' value='0' name=low_sku_id_check + '_passenger'/>`;
            }
        }

        document.getElementById('data_id').innerHTML = text;
        document.getElementById('go_to_pax').submit();
    }
</script>

{% endblock %}
